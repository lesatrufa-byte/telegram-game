<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fantasy RPG Game</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=MedievalSharp&family=UnifrakturMaguntia&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'MedievalSharp', cursive;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #fff;
            min-height: 100vh;
            background-size: cover;
            background-position: center;
            transition: background-image 0.5s ease;
            padding: 10px;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 2px solid #ffd700;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            border-bottom: 3px solid #ffd700;
        }
        
        .title {
            font-family: 'UnifrakturMaguntia', cursive;
            font-size: 2.2em;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin-bottom: 10px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: rgba(255, 215, 0, 0.1);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #ffd700;
        }
        
        .stat-value {
            font-size: 1.3em;
            color: #ffd700;
            font-weight: bold;
        }
        
        .game-buttons {
            display: grid;
            gap: 10px;
            margin: 20px 0;
        }
        
        .game-btn {
            background: linear-gradient(45deg, #ff6b6b, #ffd700);
            border: none;
            padding: 15px;
            border-radius: 10px;
            color: #000;
            font-family: 'MedievalSharp', cursive;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
        }
        
        .game-btn:active {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }
        
        .customization {
            margin: 20px 0;
        }
        
        .bg-upload {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .bg-btn {
            background: #4ecdc4;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            margin: 5px;
            font-family: 'MedievalSharp', cursive;
        }
        
        .result {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            text-align: center;
            display: none;
        }
        
        .success {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid #2ecc71;
        }
        
        .failure {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid #e74c3c;
        }
        
        .treasure {
            background: rgba(241, 196, 15, 0.2);
            border: 1px solid #f1c40f;
        }
        
        .xp-bar {
            width: 100%;
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .xp-progress {
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ff6b6b);
            border-radius: 5px;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Fantasy RPG</h1>
            <p>–≠–ø–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è!</p>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div>–£—Ä–æ–≤–µ–Ω—å</div>
                <div class="stat-value" id="level">1</div>
            </div>
            <div class="stat-card">
                <div>–ú–æ–Ω–µ—Ç—ã</div>
                <div class="stat-value" id="coins">100</div>
            </div>
            <div class="stat-card">
                <div>–û–ø—ã—Ç</div>
                <div class="stat-value" id="exp">0/100</div>
            </div>
            <div class="stat-card">
                <div>–§–æ–Ω</div>
                <div class="stat-value" id="bg-name">default</div>
            </div>
        </div>
        
        <div class="xp-bar">
            <div class="xp-progress" id="xp-bar"></div>
        </div>
        
        <div class="game-buttons">
            <button class="game-btn" onclick="startBattle()">‚öîÔ∏è –ë–∏—Ç–≤–∞ —Å –º–æ–Ω—Å—Ç—Ä–æ–º</button>
            <button class="game-btn" onclick="findTreasure()">üí∞ –ù–∞–π—Ç–∏ —Å–æ–∫—Ä–æ–≤–∏—â–µ</button>
            <button class="game-btn" onclick="magicQuest()">üîÆ –ú–∞–≥–∏—á–µ—Å–∫–∏–π –∫–≤–µ—Å—Ç</button>
        </div>
        
        <div class="result" id="result">
            <h3 id="result-title">–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
            <p id="result-text"></p>
            <button class="bg-btn" onclick="hideResult()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
        
        <div class="customization">
            <div class="bg-upload">
                <h3>üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ–Ω–∞</h3>
                <input type="file" id="bg-upload" accept="image/*" style="display: none;" onchange="uploadBackground(this.files[0])">
                <button class="bg-btn" onclick="document.getElementById('bg-upload').click()">
                    üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ–Ω
                </button>
                <button class="bg-btn" onclick="changeBackground('forest')">üå≤ –õ–µ—Å</button>
                <button class="bg-btn" onclick="changeBackground('ocean')">üåä –û–∫–µ–∞–Ω</button>
                <button class="bg-btn" onclick="changeBackground('fire')">üî• –û–≥–æ–Ω—å</button>
                <button class="bg-btn" onclick="changeBackground('default')">üîÆ –°—Ç–∞–Ω–¥–∞—Ä—Ç</button>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
            <button class="game-btn" onclick="saveGame()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä—É</button>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã
        let gameData = {
            coins: 100,
            level: 1,
            experience: 0,
            background: 'default',
            expToNextLevel: 100
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        function loadGameData() {
            const saved = localStorage.getItem('fantasyRpgSave');
            if (saved) {
                gameData = {...gameData, ...JSON.parse(saved)};
            }
            updateUI();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            document.getElementById('level').textContent = gameData.level;
            document.getElementById('coins').textContent = gameData.coins;
            document.getElementById('exp').textContent = `${gameData.experience}/${gameData.expToNextLevel}`;
            document.getElementById('bg-name').textContent = gameData.background;
            
            const xpPercent = (gameData.experience / gameData.expToNextLevel) * 100;
            document.getElementById('xp-bar').style.width = `${xpPercent}%`;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ–Ω
            applyBackground();
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞
        function applyBackground() {
            const backgrounds = {
                'default': 'linear-gradient(135deg, #1a1a2e, #16213e)',
                'forest': 'linear-gradient(135deg, #2d5a27, #1e3c1e)',
                'ocean': 'linear-gradient(135deg, #1a5276, #154360)',
                'fire': 'linear-gradient(135deg, #b03a2e, #78281f)'
            };
            
            if (gameData.background.startsWith('custom_')) {
                const bgUrl = localStorage.getItem(gameData.background);
                if (bgUrl) {
                    document.body.style.backgroundImage = `url(${bgUrl})`;
                }
            } else {
                document.body.style.backgroundImage = 'none';
                document.body.style.background = backgrounds[gameData.background] || backgrounds['default'];
            }
        }

        // –ë–∏—Ç–≤–∞ —Å –º–æ–Ω—Å—Ç—Ä–æ–º
        function startBattle() {
            const monsters = ['üêâ –î—Ä–∞–∫–æ–Ω', 'üëπ –ì–æ–±–ª–∏–Ω', 'üßü –ó–æ–º–±–∏', 'üê∫ –û–±–æ—Ä–æ—Ç–µ–Ω—å'];
            const monster = monsters[Math.floor(Math.random() * monsters.length)];
            const victory = Math.random() > 0.3;
            
            if (victory) {
                const coins = Math.floor(Math.random() * 30) + 20;
                const exp = Math.floor(Math.random() * 25) + 15;
                
                gameData.coins += coins;
                gameData.experience += exp;
                
                showResult('–ü–û–ë–ï–î–ê! ‚öîÔ∏è', 
                    `–¢—ã –ø–æ–±–µ–¥–∏–ª ${monster}!\n\n` +
                    `üí∞ –ü–æ–ª—É—á–µ–Ω–æ: ${coins} –º–æ–Ω–µ—Ç\n` +
                    `‚≠ê –û–ø—ã—Ç: +${exp}`, 'success');
            } else {
                const loss = Math.floor(Math.random() * 15) + 5;
                gameData.coins = Math.max(0, gameData.coins - loss);
                
                showResult('–ü–û–†–ê–ñ–ï–ù–ò–ï üíÄ', 
                    `${monster} –æ–∫–∞–∑–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω—ã–º!\n\n` +
                    `üí∞ –ü–æ—Ç–µ—Ä—è–Ω–æ: ${loss} –º–æ–Ω–µ—Ç\n` +
                    `üí™ –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞!`, 'failure');
            }
            
            checkLevelUp();
            updateUI();
            saveToLocal();
        }

        // –ü–æ–∏—Å–∫ —Å–æ–∫—Ä–æ–≤–∏—â–∞
        function findTreasure() {
            const treasures = [
                { name: 'üíé –î—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–π –∫–∞–º–µ–Ω—å', coins: 100, exp: 50 },
                { name: 'üí∞ –ú–µ—à–æ–∫ –∑–æ–ª–æ—Ç–∞', coins: 75, exp: 30 },
                { name: '‚ö±Ô∏è –î—Ä–µ–≤–Ω—è—è –≤–∞–∑–∞', coins: 50, exp: 20 },
                { name: 'üìú –°—Ç–∞—Ä–∞—è –∫–∞—Ä—Ç–∞', coins: 25, exp: 15 },
                { name: 'üçñ –Ø–±–ª–æ–∫–æ', coins: 10, exp: 5 }
            ];
            
            const treasure = treasures[Math.floor(Math.random() * treasures.length)];
            
            gameData.coins += treasure.coins;
            gameData.experience += treasure.exp;
            
            showResult('–°–û–ö–†–û–í–ò–©–ï –ù–ê–ô–î–ï–ù–û! üéÅ', 
                `–¢—ã –Ω–∞—à–µ–ª: ${treasure.name}\n\n` +
                `üí∞ –ü–æ–ª—É—á–µ–Ω–æ: ${treasure.coins} –º–æ–Ω–µ—Ç\n` +
                `‚≠ê –û–ø—ã—Ç: +${treasure.exp}`, 'treasure');
            
            checkLevelUp();
            updateUI();
            saveToLocal();
        }

        // –ú–∞–≥–∏—á–µ—Å–∫–∏–π –∫–≤–µ—Å—Ç
        function magicQuest() {
            const quests = [
                { name: 'üîÆ –ò—Å—Ü–µ–ª–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–Ω–∏', reward: 80 },
                { name: '‚ú® –°–æ–∑–¥–∞–Ω–∏–µ –∑–µ–ª—å—è', reward: 60 },
                { name: 'üìñ –ò–∑—É—á–µ–Ω–∏–µ —Å–≤–∏—Ç–∫–∞', reward: 40 }
            ];
            
            const quest = quests[Math.floor(Math.random() * quests.length)];
            const exp = Math.floor(Math.random() * 35) + 20;
            
            gameData.coins += quest.reward;
            gameData.experience += exp;
            
            showResult('–ö–í–ï–°–¢ –í–´–ü–û–õ–ù–ï–ù! üåü', 
                `${quest.name}\n\n` +
                `üí∞ –ù–∞–≥—Ä–∞–¥–∞: ${quest.reward} –º–æ–Ω–µ—Ç\n` +
                `‚≠ê –û–ø—ã—Ç: +${exp}`, 'success');
            
            checkLevelUp();
            updateUI();
            saveToLocal();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
        function checkLevelUp() {
            while (gameData.experience >= gameData.expToNextLevel) {
                gameData.level++;
                gameData.experience -= gameData.expToNextLevel;
                gameData.expToNextLevel = gameData.level * 100;
                
                showResult('–ù–û–í–´–ô –£–†–û–í–ï–ù–¨! üéâ', 
                    `–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –¢—ã –¥–æ—Å—Ç–∏–≥ ${gameData.level} —É—Ä–æ–≤–Ω—è!\n\n` +
                    `üéØ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä—ã—Ç—ã!`, 'success');
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        function showResult(title, text, type) {
            const result = document.getElementById('result');
            result.style.display = 'block';
            result.className = `result ${type}`;
            document.getElementById('result-title').textContent = title;
            document.getElementById('result-text').innerHTML = text.replace(/\n/g, '<br>');
        }

        // –°–∫—Ä—ã—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        function hideResult() {
            document.getElementById('result').style.display = 'none';
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ–Ω–∞
        function uploadBackground(file) {
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const bgKey = `custom_${Date.now()}`;
                    localStorage.setItem(bgKey, e.target.result);
                    gameData.background = bgKey;
                    updateUI();
                    saveToLocal();
                };
                reader.readAsDataURL(file);
            }
        }

        // –°–º–µ–Ω–∞ —Ñ–æ–Ω–∞
        function changeBackground(bg) {
            gameData.background = bg;
            updateUI();
            saveToLocal();
        }

        // –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        function saveToLocal() {
            localStorage.setItem('fantasyRpgSave', JSON.stringify(gameData));
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã –≤ Telegram
        function saveGame() {
            saveToLocal();
            if (window.Telegram && Telegram.WebApp) {
                Telegram.WebApp.sendData(JSON.stringify(gameData));
                showResult('–°–û–•–†–ê–ù–ï–ù–û! üíæ', '–î–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Telegram!', 'success');
            } else {
                showResult('–°–û–•–†–ê–ù–ï–ù–û! üíæ', '–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ.', 'success');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadGameData();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
            if (window.Telegram && Telegram.WebApp) {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
                
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç –±–æ—Ç–∞
                const initData = Telegram.WebApp.initDataUnsafe;
                if (initData.user) {
                    console.log('User:', initData.user);
                }
            }
        });
    </script>
</body>
</html>
